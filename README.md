# ds97spcheck

`ksp計算機ツール.html` は、ダビスタ（ダービースタリオン）向けの KSP 候補を確認するための、単一 HTML の試作（ワイヤーフレーム）ツールです。  
ブラウザで開くだけで動作し、種牡馬・繁殖牝馬の簡易DB（価格・頭文字など）は HTML 内に埋め込み済みです（CSV の読み込みは行いません）。

## 動作環境

- Google Chrome / Microsoft Edge などのモダンブラウザ
- インターネット接続不要（ローカルで完結）

## ファイル構成

- `ksp計算機ツール.html`
  - 本体（UI / ロジック / データ埋め込みを含む）
- `馬データ/種牡馬データ.csv`
- `馬データ/種牡馬データ_ID＋行付き.csv`
  - 種牡馬データの元ファイル（本体は直接読み込みません）
- `馬データ/繁殖牝馬データ.csv`
- `馬データ/繁殖牝馬データ_ID＋行付き.csv`
  - 繁殖牝馬データの元ファイル（本体は直接読み込みません）

## 動かし方

1. `ksp計算機ツール.html` をブラウザで開く
2. 左の入力エリアで必要項目を入力
3. 必要なら `ＳＰコメント週チェック` でスピード位置を確定
4. `KSP計算` ボタンで結果を表示
5. 必要なら `データをリストに追加` で結果を保存

ビルドやサーバ起動は不要です（単一HTMLで動作）。

## 使い方

### 1) 基本入力

- 仔馬価格
- 性別（牡 / 牝）
- 種牡馬価格（または種牡馬名選択で自動入力）
- 母馬価格（または母馬名選択で自動入力）
- 母馬価格の補足: 牝馬価格 = 引退時の本賞金 + 400（上限 25000）
- ベスト体重（kg）
- 成長型
- 入厩月 / 入厩週（必要に応じて）

### 2) コメント週の入力（任意）

- 最初のクリックでスピード位置を確定し、候補の絞り込みを有効化
- 2回目以降は各コメントセルを選択して保存時の要約に利用
- 健康系コメントのマスはクリックで状態切り替えが可能
- 不要なら `コメント週リセット` で初期化

### 3) 計算実行と結果確認

- `KSP計算` で結果を表示
- コメント週未設定時は範囲表示、設定時は候補の詳細表示
- 必要なら `データをリストに追加` で保存

## ボタンの意味

### 入力エリア

- `全項目のリセット`
  - 主要入力・コメント週・計算表示を初期化
- `+10 / -10 / +50 / -50`（ベスト体重の横）
  - ベスト体重を素早く増減
- `4月1週に戻す`
  - 入厩月 / 入厩週を初期値に戻す
- `コメント週リセット`
  - コメント週グリッドの選択状態をクリア

### 計算・保存

- `KSP計算`
  - 現在の入力内容でKSP表示を更新
- `データをリストに追加`
  - 直前の計算結果を保存リストへ追加
- `選択リスト削除`（右側リストエリア）
  - 指定したリスト番号の保存データを削除

### 履歴エリア

- `母馬価格に戻す`（各履歴行）
  - 対応する履歴価格を母馬価格入力欄へ復元

## 出力（KSP計算結果）

- `KSP計算` 実行後、以下のいずれかで表示
- スピード位置未確定: KSP範囲（min〜max）
- スピード位置確定: 候補1〜6の `KSP=値` を最大6件表示
- 候補がない場合: 条件に合う候補なしメッセージ

## 付帯機能

- 種牡馬 / 母馬の候補選択
  - 系統・頭文字で絞り込み、馬名選択で価格を反映
- 計算結果のリスト保存（最大3件）
  - KSP結果、成長型、コメント要約を保存
- 母馬価格履歴（最大3件）
  - 直近の価格を保持し、ワンクリック再入力
- コメント補助チェック
  - `2歳素質` / `2歳賢い` を保存要約に反映

## 注意事項

- 入力不足時は計算できません。必須項目を先に入力してください。
- 文字化けして見える環境では、エディタ/ターミナル側の文字コード設定をUTF-8にしてください。
- 馬データはHTML内に埋め込みです。外部CSV読み込みは不要です。

## 注意点（ワイヤーフレームとしての制約）

- ブラウザを閉じると保存済みリスト等は消えます（永続化は未実装）
- データ更新は HTML 内の埋め込み配列（`STALLION_DATA`, `MARE_DATA`）の更新が必要
- 画面サイズは固定（幅 840px / 高さ 500px）

## 免責

本ツールは個人利用想定の試作です。ゲーム内仕様・攻略情報の正確性を保証するものではありません。
